{"version":3,"sources":["../../src/js/script.js"],"names":["Util","amount","decimalCount","decimal","thousands","isNaN","format","minimumFractionDigits","style","currency","toLocaleString","EnjoeiModal","title","text","width","document","querySelector","offsetWidth","console","log","Swal","fire","showCloseButton","showCancelButton","showConfirmButton","imageUrl","imageWidth","imageHeight","imageAlt","customClass","container","popup","header","closeButton","image","content","input","actions","confirmButton","cancelButton","footer","ActionButtons","getElementById","_bind_click_buttons","modal","onclick","confirm","cancel","PathParam","array","window","location","pathname","split","filter","item","result","i","length","SummarySection","voucher_id","fields","shippingPrice","checkout","totalPrice","price","product","cupons","availableCoupons","hasVoucher","_print","bold","cupom","find","id","discount","accent","value","opts","element","innerText","formatMoney","className","classList","add","CupomSection","couponSectionList","cupomAmountDetail","unshift","voucherOnScreen","querySelectorAll","innerHTML","forEach","html","appendChild","el","onchange","LoadCheckoutPage","params","div","createElement","htmlString","trim","firstChild","checkout_id","perform","url","concat","fetch","then","json","summarySection","printAll","cupomSection","printAvailables","bindChanges","$","ready"],"mappings":"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","sourcesContent":["(function(){\n  class Util{\n    static formatMoney(amount, decimalCount = 2, decimal = \",\", thousands = \".\") {\n      if(isNaN(amount)){  \n        return \"\"\n      }\n      const format = { minimumFractionDigits: 2, style: 'currency', currency: 'BRL' }\n      return amount.toLocaleString('pt-BR', format);\n    }\n  }\n  //ModalScript\n  class EnjoeiModal {\n    constructor(title, text){\n      this.title = title;\n      this.text = text;\n    }\n    \n    fire(){\n      let width = `${document.querySelector('.container').offsetWidth}px`\n      console.log('wi',width);\n      Swal.fire({\n        title: this.title || 'compra efetuada',\n        text: this.text || 'enviaremos informacoes por email',\n        showCloseButton: false,\n        showCancelButton: false,\n        showConfirmButton: false,\n        imageUrl: 'https://unsplash.it/40/40',\n        imageWidth: 40,\n        imageHeight: 40,\n        imageAlt: 'Custom image',\n        width: '280px',\n        customClass: {\n          container: 'enjoei-modal-container-class',\n          popup: 'enjoei-modal-popup-class',\n          header: 'enjoei-modal-header-class',\n          title: 'enjoei-modal-title-class',\n          closeButton: 'enjoei-modal-close-button-class',\n          image: 'enjoei-modal-image-class',\n          content: 'enjoei-modal-content-class',\n          input: 'enjoei-modal-input-class',\n          actions: 'enjoei-modal-actions-class',\n          confirmButton: 'enjoei-modal-confirm-button-class',\n          cancelButton: 'enjoei-modal-cancel-button-class',\n          footer: 'enjoei-modal-footer-class'\n        }\n      });\n    }\n  }\n  //ButtonScript\n  class ActionButtons{\n    constructor() {\n      this.confirmButton = document.getElementById('confirm-button');\n      this.cancelButton = document.getElementById('cancel-button');\n      this._bind_click_buttons();\n    }\n\n    confirm() {\n      const title = 'compra confirmada';\n      const text = 'enviaremos atualizações sobre o pedido para o seu email';\n      const modal = new EnjoeiModal(title, text)\n      modal.fire()\n    }\n\n    cancel() {\n      const title = 'compra cancelada';\n      const text = 'pedido não foi enviado e você não sera cobrado'\n      const modal = new EnjoeiModal(title,text)\n      modal.fire()\n    }\n\n    _bind_click_buttons(){\n      this.confirmButton.onclick = this.confirm\n      this.cancelButton.onclick = this.cancel\n    }\n  }\n  //PathParamRouter\n  class PathParam {\n    static params() {\n      const array = window.location.pathname.split('/').filter(item => item !== \"\")\n      const result = {}\n      for (let i = 0; i < array.length; i = i + 2) {\n        result[array[i]] = array[i + 1];\n      }\n      return result;\n    }\n  }\n  //Summary\n  class SummarySection{\n    constructor(result, voucher_id = -1){\n      this.fields = {\n        shippingPrice: result.checkout.shippingPrice,\n        totalPrice: result.checkout.totalPrice,\n        price: result.product.price,\n        image: result.product.image,\n        cupons: result.checkout.availableCoupons\n      }\n      //the api doesnt say if voucher has applied\n      if (voucher_id && voucher_id != -1) {\n        this.fields = {\n          ...this.fields,\n          hasVoucher: true,\n          voucher_id: voucher_id\n        }\n      }\n    }\n\n    printAll(){\n      this._print('amount-total', this.fields.totalPrice, { bold: true });\n      this._print('amount-shipping', this.fields.shippingPrice);\n      this._print('amount-original', this.fields.price);\n\n      //if there are more one available voucher, find the correct\n      if(this.fields.hasVoucher === true){\n        const cupom = this.fields.cupons.find(cupom => {\n          return cupom.id == this.fields.voucher_id\n        })\n        \n        this._print('amount-discount', cupom.discount * -1,{accent: true});\n      }else{\n        this._print('amount-discount', 0);\n      }\n    }\n    \n    _print(id, value, opts = {}){\n      const element = document.querySelector(`#${id}`)\n      element.innerText = Util.formatMoney(value)\n      element.className = '';\n\n      if(opts.accent)\n        element.classList.add(\"accent-text\");\n        \n      if (opts.bold) \n        element.classList.add(\"bold-text\");\n    }\n  }\n\n  //Cupons\n  class CupomSection{\n    constructor(cupons){\n      this.cupons = cupons;\n      this.couponSectionList = document.getElementById('coupons-list');\n      this.cupomAmountDetail = document.getElementById('amount-cupom-detail');\n      if(!cupons || cupons.length === 0){\n        document.getElementById('coupon-section').classList.add(\"hide\")\n        this.couponSectionList.classList.add(\"hide\");\n        this.cupomAmountDetail.classList.add(\"hide\");\n        return\n      }\n\n      this.cupons.unshift({\n        id: -1,\n        title: 'não usar cupom'\n      })\n    }\n    \n    printAvailables(){\n      const voucherOnScreen = document.querySelectorAll(\".voucher-item\").length\n      //return if all vouchers are on the screen\n      if(voucherOnScreen === this.cupons.length){\n        return\n      }\n      this.couponSectionList.innerHTML = \"\"\n      this.cupons.forEach(cupom => {\n        let html = this._print(cupom)\n        this.couponSectionList.appendChild(html)\n      });\n    }\n\n    bindChanges(){\n      document.querySelectorAll(\"input[name='voucher']\").forEach(function (el) {\n        el.onchange = function(){\n          const voucher_id = document.querySelector(\"input[name='voucher']:checked\").value\n          new LoadCheckoutPage(PathParam.params().checkout, voucher_id);\n        }\n      })\n    }\n    \n    _print(cupom){\n      const div = document.createElement('div');\n      const htmlString = `<div class=\"item-detail voucher-item\">\n        <label class=\"radio-button row x-between\">${cupom.title}\n        <input type=\"radio\" name=\"voucher\" value=\"${cupom.id}\">\n        <span class=\"checkmark\"></span>\n        <span class=\"accent-text\">${Util.formatMoney(cupom.discount * -1)}</span>\n        </label>\n      </div>`\n      div.innerHTML = htmlString.trim();\n      return div.firstChild\n    }\n  }\n\n  //Load checkout page\n  class LoadCheckoutPage{\n    constructor(checkout_id, voucher_id = -1){\n      this.checkout_id = checkout_id;\n      this.voucher_id = voucher_id;\n      this.hasVoucher = false;\n      this.perform();\n    }\n\n    perform(){\n      let url = `/api/checkouts/${this.checkout_id}`\n      if(this.voucher_id != -1){\n        url = url.concat(`?couponId=${this.voucher_id}`);\n      }\n      fetch(url)\n        .then((result) => result.json())\n        .then((result) => {\n          const summarySection  = new SummarySection(result, this.voucher_id)\n          summarySection.printAll();\n\n          const cupomSection = new CupomSection(result.checkout.availableCoupons)\n          cupomSection.printAvailables();\n          cupomSection.bindChanges();\n        })\n    }\n  }\n\n  $(document).ready(() =>{\n    new LoadCheckoutPage(PathParam.params().checkout);\n    new ActionButtons();\n  })\n})();"],"file":"script.js"}